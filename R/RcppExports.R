# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Backward Sampler for the Bounded Coalescent
#'
#' Samples the number of lineages at specified times given forward
#' probabilities
#'
#' @param forward_probs 2D array of probabilities from the forward algorithm.
#' @param times Vector of ordered sampling times for leaves.
#' @param leaves Number of leaves taken at each sampling time.
#' @param Ne Effective population size.
#' @param bound Bound time.
#' @param bound_size Number of lineages at the bound (default 1).
#' @export
backward_sampler_c <- function(forward_probs, times, leaves, Ne, bound, bound_size = 1L) {
    .Call(`_BoundedCoalescent_backward_sampler_c`, forward_probs, times, leaves, Ne, bound, bound_size)
}

#' Forward Algorithm for the Bounded Coalescent
#'
#' Calculate the forward probabilities for the bounded coalescent.
#'
#' @param times Vector of ordered sampling times for leaves.
#' @param leaves Number of leaves taken at each sampling time.
#' @param Ne Effective population size.
#' @param bound Bound time.
#' @export
forward_algorithm_c <- function(times, leaves, Ne, bound) {
    .Call(`_BoundedCoalescent_forward_algorithm_c`, times, leaves, Ne, bound)
}

#' Calculate coalescent probabilities (homochronous)
#'
#' Calculate the probability of i lineages coalescing down to j <= i lineages
#' in time dt in the homochronous setting.
#'
#' @param i Integer value for the starting number of lineages.
#' @param j Integer value for the final number of lineages.
#' @param dt Time period over which coalescences can occur.
#' @param Ne Effective population size.
#' @export
homochronous_probability <- function(i, j, dt, Ne) {
    .Call(`_BoundedCoalescent_homochronous_probability`, i, j, dt, Ne)
}

